{
  "args": {
    "workflowPaths": {
      "inProcess": {
        "home": "/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e"
      },
      "egress": {
        "home": "/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e"
      }
    },
    "walkRootPaths": [
      "support/assurance/ingestion-center-elt/drh/synthetic-content"
    ],
    "referenceDataHome": "/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data",
    "sources": [
      {
        "uri": "support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv",
        "nature": "CSV",
        "tableName": "libre_20240307",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx",
        "nature": "ERROR",
        "tableName": "ERROR",
        "ingestionIssues": 1
      },
      {
        "uri": "support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv",
        "nature": "ERROR",
        "tableName": "ERROR",
        "ingestionIssues": 1
      },
      {
        "uri": "support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv",
        "nature": "CSV",
        "tableName": "glucose_20240307",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "libre_data_240402_m_y_b004_libre_data",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "libre_data_240402_m_y_b001_libre_data",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "libre_data_240402_m_y_b006_libre_data",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv",
        "nature": "CSV",
        "tableName": "vitalsigns_20240307",
        "ingestionIssues": 0
      },
      {
        "uri": "/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv",
        "nature": "CSV",
        "tableName": "screening_status_code_reference",
        "ingestionIssues": 0
      },
      {
        "uri": "/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv",
        "nature": "CSV",
        "tableName": "business_rules",
        "ingestionIssues": 0
      }
    ]
  },
  "diags": [
    {
      "insertable": {
        "exec_identity": "init",
        "exec_code": "duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', 'vinod-OptiPlex', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7bab389e-54af-5a13-a39f-079abdc73a48', '0.12.0', ('2024-04-16T08:48:44.333Z'), NULL, NULL, NULL, NULL, 'Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found",
        "orch_session_exec_id": "168a34c7-d043-5ec4-a84a-c961f1a301ef",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', 'vinod-OptiPlex', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7bab389e-54af-5a13-a39f-079abdc73a48', '0.12.0', ('2024-04-16T08:48:44.333Z'), NULL, NULL, NULL, NULL, 'Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', 'vinod-OptiPlex', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7bab389e-54af-5a13-a39f-079abdc73a48', '0.12.0', ('2024-04-16T08:48:44.333Z'), NULL, NULL, NULL, NULL, 'Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "ingest",
        "exec_code": "duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb --json",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv (libre_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv', 'libre_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '8b7c669c-1795-5f6b-8f3a-3e502b74c628' as session_entry_id\n    FROM read_csv_auto('support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv', types={'device': 'VARCHAR', 'serial number': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_20240307.',\n           'Ensure libre_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '641dff51-97fd-56b3-8443-c1ed568a6d66', 'Sheet Missing', 'Excel workbook sheet ''MYB004_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '47277588-99e8-59f5-8384-b24344a86073', 'Sheet Missing', 'Excel workbook sheet ''MYB001_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a26ce332-3ced-5623-861d-23a2ef78e4a9', 'Sheet Missing', 'Excel workbook sheet ''MYB006_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'ae477ba1-c7f1-5f34-847a-50bddb7130aa', 'Unknown CSV File Type', 'CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv (glucose_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv', 'glucose_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE glucose_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0' as session_entry_id\n    FROM read_csv_auto('support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'glucose_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in glucose_20240307.',\n           'Ensure glucose_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b004_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', 'libre_data_240402_m_y_b004_libre_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'MYB004_Libre_data' into libre_data_240402_m_y_b004_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b004_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '3b4eb0e5-6239-537a-8e67-e50e172e72a2' as session_entry_id\n    FROM st_read('support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', layer='MYB004_Libre_data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_data_240402_m_y_b004_libre_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_data_240402_m_y_b004_libre_data.',\n           'Ensure libre_data_240402_m_y_b004_libre_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b001_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a530fe1b-57ef-5a90-8bea-835ece2483da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', 'libre_data_240402_m_y_b001_libre_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a3fe7098-8ae8-5612-81ac-cbe10780c19b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'MYB001_Libre_data' into libre_data_240402_m_y_b001_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b001_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'a530fe1b-57ef-5a90-8bea-835ece2483da' as session_entry_id\n    FROM st_read('support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', layer='MYB001_Libre_data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_data_240402_m_y_b001_libre_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_data_240402_m_y_b001_libre_data.',\n           'Ensure libre_data_240402_m_y_b001_libre_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('99e72a60-96ab-5ef1-a3af-3e7759777664', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b006_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e36daa69-3c63-5384-b6a7-03fa3b00641d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', 'libre_data_240402_m_y_b006_libre_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('89f7ec04-277a-5799-afaa-a70d0f2a8ed5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'MYB006_Libre_data' into libre_data_240402_m_y_b006_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b006_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'e36daa69-3c63-5384-b6a7-03fa3b00641d' as session_entry_id\n    FROM st_read('support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', layer='MYB006_Libre_data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_data_240402_m_y_b006_libre_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_data_240402_m_y_b006_libre_data.',\n           'Ensure libre_data_240402_m_y_b006_libre_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c60cf3db-b1bf-5103-b278-b0c128ce924a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv (vitalsigns_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv', 'vitalsigns_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b10e248d-8c94-59ec-83fc-a1249dd3b111', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE vitalsigns_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f' as session_entry_id\n    FROM read_csv_auto('support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv', types={'dataset_id': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'vitalsigns_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in vitalsigns_20240307.',\n           'Ensure vitalsigns_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5222b730-9add-5b52-b0c9-6f2506b0af9d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('fa7874f6-f848-572b-a9ab-9db4c8d5e959', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv', 'screening_status_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c302047e-21cf-5059-a32c-e81a9bd3a9b9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'fa7874f6-f848-572b-a9ab-9db4c8d5e959' as session_entry_id\n    FROM read_csv_auto('/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Lvl'), ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_status_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'fa7874f6-f848-572b-a9ab-9db4c8d5e959',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_status_code_reference.',\n           'Ensure screening_status_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3252fee6-3a9a-5f4c-81c6-739201046d79', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv', 'business_rules', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9860873a-c387-5d98-9930-4ff296eb7192', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7' as session_entry_id\n    FROM read_csv_auto('/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Worksheet'), ('Field'), ('Required'), ('Permissible Values'), ('True Rejection'), ('Warning Layer'), ('Resolved by QE/QCS')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'business_rules')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in business_rules.',\n           'Ensure business_rules contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_20240307' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '641dff51-97fd-56b3-8443-c1ed568a6d66',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '47277588-99e8-59f5-8384-b24344a86073',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a26ce332-3ced-5623-861d-23a2ef78e4a9',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'ae477ba1-c7f1-5f34-847a-50bddb7130aa',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'glucose_20240307' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_data_240402_m_y_b004_libre_data' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_data_240402_m_y_b001_libre_data' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_data_240402_m_y_b006_libre_data' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'vitalsigns_20240307' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'screening_status_code_reference' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'fa7874f6-f848-572b-a9ab-9db4c8d5e959',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'business_rules' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05269d28-15ae-5bd6-bd88-f949ccfa52d7'",
        "output_nature": "JSON",
        "orch_session_exec_id": "46171763-bd21-57a8-a403-0785f72643cf",
        "exec_nature": "duckdb",
        "exec_status": 1,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv (libre_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv', 'libre_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '8b7c669c-1795-5f6b-8f3a-3e502b74c628' as session_entry_id\n    FROM read_csv_auto('support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv', types={'device': 'VARCHAR', 'serial number': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_20240307.',\n           'Ensure libre_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '641dff51-97fd-56b3-8443-c1ed568a6d66', 'Sheet Missing', 'Excel workbook sheet ''MYB004_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '47277588-99e8-59f5-8384-b24344a86073', 'Sheet Missing', 'Excel workbook sheet ''MYB001_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a26ce332-3ced-5623-861d-23a2ef78e4a9', 'Sheet Missing', 'Excel workbook sheet ''MYB006_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'ae477ba1-c7f1-5f34-847a-50bddb7130aa', 'Unknown CSV File Type', 'CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv (glucose_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv', 'glucose_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE glucose_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0' as session_entry_id\n    FROM read_csv_auto('support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'glucose_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in glucose_20240307.',\n           'Ensure glucose_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b004_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', 'libre_data_240402_m_y_b004_libre_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'MYB004_Libre_data' into libre_data_240402_m_y_b004_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b004_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '3b4eb0e5-6239-537a-8e67-e50e172e72a2' as session_entry_id\n    FROM st_read('support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', layer='MYB004_Libre_data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_data_240402_m_y_b004_libre_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_data_240402_m_y_b004_libre_data.',\n           'Ensure libre_data_240402_m_y_b004_libre_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b001_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a530fe1b-57ef-5a90-8bea-835ece2483da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', 'libre_data_240402_m_y_b001_libre_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a3fe7098-8ae8-5612-81ac-cbe10780c19b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'MYB001_Libre_data' into libre_data_240402_m_y_b001_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b001_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'a530fe1b-57ef-5a90-8bea-835ece2483da' as session_entry_id\n    FROM st_read('support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', layer='MYB001_Libre_data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_data_240402_m_y_b001_libre_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_data_240402_m_y_b001_libre_data.',\n           'Ensure libre_data_240402_m_y_b001_libre_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('99e72a60-96ab-5ef1-a3af-3e7759777664', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b006_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e36daa69-3c63-5384-b6a7-03fa3b00641d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', 'libre_data_240402_m_y_b006_libre_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('89f7ec04-277a-5799-afaa-a70d0f2a8ed5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'MYB006_Libre_data' into libre_data_240402_m_y_b006_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b006_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'e36daa69-3c63-5384-b6a7-03fa3b00641d' as session_entry_id\n    FROM st_read('support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', layer='MYB006_Libre_data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_data_240402_m_y_b006_libre_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_data_240402_m_y_b006_libre_data.',\n           'Ensure libre_data_240402_m_y_b006_libre_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c60cf3db-b1bf-5103-b278-b0c128ce924a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv (vitalsigns_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv', 'vitalsigns_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b10e248d-8c94-59ec-83fc-a1249dd3b111', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE vitalsigns_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f' as session_entry_id\n    FROM read_csv_auto('support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv', types={'dataset_id': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'vitalsigns_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in vitalsigns_20240307.',\n           'Ensure vitalsigns_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5222b730-9add-5b52-b0c9-6f2506b0af9d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('fa7874f6-f848-572b-a9ab-9db4c8d5e959', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv', 'screening_status_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c302047e-21cf-5059-a32c-e81a9bd3a9b9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'fa7874f6-f848-572b-a9ab-9db4c8d5e959' as session_entry_id\n    FROM read_csv_auto('/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Lvl'), ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_status_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'fa7874f6-f848-572b-a9ab-9db4c8d5e959',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_status_code_reference.',\n           'Ensure screening_status_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3252fee6-3a9a-5f4c-81c6-739201046d79', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv', 'business_rules', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9860873a-c387-5d98-9930-4ff296eb7192', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7' as session_entry_id\n    FROM read_csv_auto('/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Worksheet'), ('Field'), ('Required'), ('Permissible Values'), ('True Rejection'), ('Warning Layer'), ('Resolved by QE/QCS')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'business_rules')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in business_rules.',\n           'Ensure business_rules contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_20240307' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '641dff51-97fd-56b3-8443-c1ed568a6d66',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '47277588-99e8-59f5-8384-b24344a86073',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a26ce332-3ced-5623-861d-23a2ef78e4a9',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'ae477ba1-c7f1-5f34-847a-50bddb7130aa',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'glucose_20240307' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_data_240402_m_y_b004_libre_data' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_data_240402_m_y_b001_libre_data' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_data_240402_m_y_b006_libre_data' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'vitalsigns_20240307' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'screening_status_code_reference' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'fa7874f6-f848-572b-a9ab-9db4c8d5e959',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'business_rules' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05269d28-15ae-5bd6-bd88-f949ccfa52d7'",
        "exec_error_text": "Error: near line 67: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\nError: near line 201: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\n",
        "output_text": "[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'MYB004_Libre_data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'MYB001_Libre_data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"orch_session_issue_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'MYB006_Libre_data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"orch_session_issue_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file 'synthetic-fail.csv' not found in 'synthetic-fail.csv'\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv\"}]\n",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv (libre_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv', 'libre_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '8b7c669c-1795-5f6b-8f3a-3e502b74c628' as session_entry_id\n    FROM read_csv_auto('support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv', types={'device': 'VARCHAR', 'serial number': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_20240307.',\n           'Ensure libre_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '641dff51-97fd-56b3-8443-c1ed568a6d66', 'Sheet Missing', 'Excel workbook sheet ''MYB004_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '47277588-99e8-59f5-8384-b24344a86073', 'Sheet Missing', 'Excel workbook sheet ''MYB001_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a26ce332-3ced-5623-861d-23a2ef78e4a9', 'Sheet Missing', 'Excel workbook sheet ''MYB006_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'ae477ba1-c7f1-5f34-847a-50bddb7130aa', 'Unknown CSV File Type', 'CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''', NULL, NULL, 'support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv (glucose_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv', 'glucose_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE glucose_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0' as session_entry_id\n    FROM read_csv_auto('support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'glucose_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in glucose_20240307.',\n           'Ensure glucose_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b004_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', 'libre_data_240402_m_y_b004_libre_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'MYB004_Libre_data' into libre_data_240402_m_y_b004_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b004_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '3b4eb0e5-6239-537a-8e67-e50e172e72a2' as session_entry_id\n    FROM st_read('support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', layer='MYB004_Libre_data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_data_240402_m_y_b004_libre_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_data_240402_m_y_b004_libre_data.',\n           'Ensure libre_data_240402_m_y_b004_libre_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b001_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a530fe1b-57ef-5a90-8bea-835ece2483da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', 'libre_data_240402_m_y_b001_libre_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a3fe7098-8ae8-5612-81ac-cbe10780c19b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'MYB001_Libre_data' into libre_data_240402_m_y_b001_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b001_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'a530fe1b-57ef-5a90-8bea-835ece2483da' as session_entry_id\n    FROM st_read('support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', layer='MYB001_Libre_data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_data_240402_m_y_b001_libre_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_data_240402_m_y_b001_libre_data.',\n           'Ensure libre_data_240402_m_y_b001_libre_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('99e72a60-96ab-5ef1-a3af-3e7759777664', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b006_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e36daa69-3c63-5384-b6a7-03fa3b00641d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', 'libre_data_240402_m_y_b006_libre_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('89f7ec04-277a-5799-afaa-a70d0f2a8ed5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'MYB006_Libre_data' into libre_data_240402_m_y_b006_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b006_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'e36daa69-3c63-5384-b6a7-03fa3b00641d' as session_entry_id\n    FROM st_read('support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx', layer='MYB006_Libre_data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('device'), ('serial number'), ('time stamp'), ('glucose value')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'libre_data_240402_m_y_b006_libre_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in libre_data_240402_m_y_b006_libre_data.',\n           'Ensure libre_data_240402_m_y_b006_libre_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c60cf3db-b1bf-5103-b278-b0c128ce924a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv (vitalsigns_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv', 'vitalsigns_20240307', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b10e248d-8c94-59ec-83fc-a1249dd3b111', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE vitalsigns_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f' as session_entry_id\n    FROM read_csv_auto('support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv', types={'dataset_id': 'VARCHAR'});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'vitalsigns_20240307')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in vitalsigns_20240307.',\n           'Ensure vitalsigns_20240307 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5222b730-9add-5b52-b0c9-6f2506b0af9d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('fa7874f6-f848-572b-a9ab-9db4c8d5e959', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv', 'screening_status_code_reference', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c302047e-21cf-5059-a32c-e81a9bd3a9b9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'fa7874f6-f848-572b-a9ab-9db4c8d5e959' as session_entry_id\n    FROM read_csv_auto('/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Lvl'), ('Code'), ('Display'), ('Definition')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_status_code_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'fa7874f6-f848-572b-a9ab-9db4c8d5e959',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_status_code_reference.',\n           'Ensure screening_status_code_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3252fee6-3a9a-5f4c-81c6-739201046d79', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv', 'business_rules', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9860873a-c387-5d98-9930-4ff296eb7192', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7' as session_entry_id\n    FROM read_csv_auto('/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('Worksheet'), ('Field'), ('Required'), ('Permissible Values'), ('True Rejection'), ('Warning Layer'), ('Resolved by QE/QCS')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'business_rules')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in business_rules.',\n           'Ensure business_rules contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_20240307' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '641dff51-97fd-56b3-8443-c1ed568a6d66',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '47277588-99e8-59f5-8384-b24344a86073',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a26ce332-3ced-5623-861d-23a2ef78e4a9',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'ERROR' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'ae477ba1-c7f1-5f34-847a-50bddb7130aa',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'glucose_20240307' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_data_240402_m_y_b004_libre_data' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_data_240402_m_y_b001_libre_data' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'libre_data_240402_m_y_b006_libre_data' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'vitalsigns_20240307' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'screening_status_code_reference' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'fa7874f6-f848-572b-a9ab-9db4c8d5e959',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT 'libre_20240307'\n        AS table_name,\n        'LIBRE' AS table_name_suffix\n      UNION ALL\n      SELECT 'vitalsigns_20240307'\n        AS table_name,\n        'VITALSIGNS' AS table_name_suffix\n      UNION ALL\n      SELECT 'glucose_20240307'\n        AS table_name,\n        'GLUCOSE' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    'business_rules' IN (\n      'libre_20240307',\n      'vitalsigns_20240307',\n      'glucose_20240307'\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7',\n           'CSV File Missing',\n           NULL,\n           NULL,\n           table_name,\n           'CSV file ' || table_name_suffix || '_20240307 not found under the group (_20240307)',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05269d28-15ae-5bd6-bd88-f949ccfa52d7'\n```\n### `ingest` STDOUT (status: `1`)\n```json\n[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'MYB004_Libre_data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'MYB001_Libre_data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"orch_session_issue_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'MYB006_Libre_data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"orch_session_issue_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file 'synthetic-fail.csv' not found in 'synthetic-fail.csv'\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv\"}]\n\n```\n### `ingest` STDERR\n```sh\nError: near line 67: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\nError: near line 201: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\n\n```\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "ensureContent",
        "exec_code": "duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c2c0cbca-70cb-54f6-9dc7-66b47c4f3157', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e8b3dab4-5058-5c79-8088-45b423119149', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8640a4b5-53ef-506e-bcde-83f00315d4b2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9dabd022-4a26-55f2-98f4-e534e7704b23', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('544998d3-58c5-5f65-9dc8-9f998508495f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('80af4eff-d697-565b-9e3f-a587e322b1da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0adb81bc-3df2-5f86-99cc-2d20e1dd5efd', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n        \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6fcd9df5-34cf-5c09-8fb5-e73617e28d73', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('10d0290c-b2eb-581e-b627-b5b8fcbb830f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7e65e3a7-4415-55f4-866b-3b0cc4e85fc6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e6951d0b-be59-58c3-8a04-01181208c601', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5b77d127-e62a-50a9-acee-bea63ff64dd5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2afb3098-bcfd-5a54-8ebb-4d65d399c55e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a92a6466-6fe4-58d7-8948-e2e09dc2fec2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('34e90086-3d06-5b10-972d-7d0b40a02289', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      ",
        "orch_session_exec_id": "21d7e4ec-32e3-5e20-9029-28fdd6c5fa66",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c2c0cbca-70cb-54f6-9dc7-66b47c4f3157', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e8b3dab4-5058-5c79-8088-45b423119149', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8640a4b5-53ef-506e-bcde-83f00315d4b2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9dabd022-4a26-55f2-98f4-e534e7704b23', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('544998d3-58c5-5f65-9dc8-9f998508495f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('80af4eff-d697-565b-9e3f-a587e322b1da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0adb81bc-3df2-5f86-99cc-2d20e1dd5efd', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n        \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6fcd9df5-34cf-5c09-8fb5-e73617e28d73', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('10d0290c-b2eb-581e-b627-b5b8fcbb830f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7e65e3a7-4415-55f4-866b-3b0cc4e85fc6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e6951d0b-be59-58c3-8a04-01181208c601', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5b77d127-e62a-50a9-acee-bea63ff64dd5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2afb3098-bcfd-5a54-8ebb-4d65d399c55e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a92a6466-6fe4-58d7-8948-e2e09dc2fec2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('34e90086-3d06-5b10-972d-7d0b40a02289', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      ",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c2c0cbca-70cb-54f6-9dc7-66b47c4f3157', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '8b7c669c-1795-5f6b-8f3a-3e502b74c628',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e8b3dab4-5058-5c79-8088-45b423119149', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8640a4b5-53ef-506e-bcde-83f00315d4b2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9dabd022-4a26-55f2-98f4-e534e7704b23', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('544998d3-58c5-5f65-9dc8-9f998508495f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '3b4eb0e5-6239-537a-8e67-e50e172e72a2',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('80af4eff-d697-565b-9e3f-a587e322b1da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0adb81bc-3df2-5f86-99cc-2d20e1dd5efd', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'a530fe1b-57ef-5a90-8bea-835ece2483da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n        \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6fcd9df5-34cf-5c09-8fb5-e73617e28d73', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('10d0290c-b2eb-581e-b627-b5b8fcbb830f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'device' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'serial number' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'time stamp' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'glucose value' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e36daa69-3c63-5384-b6a7-03fa3b00641d',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7e65e3a7-4415-55f4-866b-3b0cc4e85fc6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e6951d0b-be59-58c3-8a04-01181208c601', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5b77d127-e62a-50a9-acee-bea63ff64dd5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2afb3098-bcfd-5a54-8ebb-4d65d399c55e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a92a6466-6fe4-58d7-8948-e2e09dc2fec2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('34e90086-3d06-5b10-972d-7d0b40a02289', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'BusinessRulesReferenceCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n      \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "emitResources",
        "exec_code": "duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4971a2f5-06a3-5898-823d-364145d3b9a5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4f7e4436-c5f6-5ba1-9793-580ab66789fb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\n\n-- diagnostics-md-ignore-start \"SQLPage and execution diagnostics SQL DML\"\n-- emit all the SQLPage content\nCREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n\n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/info_model_schema_tables.handlebars', '{{caption}}\n<ul>\n{{#each_row}}\n    <li><a href=\"?table_nature={{nature}}&table_name={{table_name}}\">{{table_name}}</a> ({{nature}}, {{columns_count}} columns)</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('scripts/shell.js', 'function wrapSTDOUTInDetails() {\n    // Find all heading elements that could contain the STDOUT text\n    const headings = document.querySelectorAll(''h1, h2, h3, h4, h5, h6'');\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n            // Find the next <pre><code> block\n            var nextEl = heading.nextElementSibling;\n            while (nextEl) {\n                if (nextEl.matches(''pre'') && nextEl.querySelector(''code'')) {\n                    // Create the <details> and <summary> elements\n                    const details = document.createElement(''details'');\n                    const summary = document.createElement(''summary'');\n                    summary.textContent = heading.textContent;\n\n                    // Wrap the <pre><code> block in <details>\n                    nextEl.parentNode.insertBefore(details, nextEl);\n                    details.appendChild(summary);\n                    details.appendChild(nextEl);\n                    break;\n                }\n                nextEl = nextEl.nextElementSibling;\n            }\n        }\n    });\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n          heading.remove();\n        }\n    });\n}\n\ndocument.addEventListener(''DOMContentLoaded'', function() {\n  // find all code elements on the current page with the class ''language-sql'' and add the class ''line-numbers'' to each of them\n  document.querySelectorAll(''code.language-sql'').forEach(function(codeEl) {\n      var parentPre = codeEl.parentElement;\n      if (parentPre && parentPre.tagName === ''PRE'') {\n          parentPre.classList.add(''line-numbers'');\n      }\n  });\n  wrapSTDOUTInDetails();\n});\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''list'' as component;\nSELECT ''DRH Screenings'' as title,''DRH-screenings.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component, ''orch_session_id'' as markdown, ''SUMMARY'' as markdown;\nSELECT ''['' || orch_session_id || ''](session-diagnostics.sql?session_id=''|| orch_session_id ||'')'' as orch_session_id,''['' || ''Summary'' || ''](session-summary.sql?session_id=''|| orch_session_id ||'')'' as SUMMARY, device_id, orch_started_at, orch_finished_at FROM orch_session;\n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('reference.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, ''Business Rules'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM business_rules;\n\nSELECT ''text'' as component, ''AHC Cross Walk'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM ahc_cross_walk;\n\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-diagnostics.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Arguments '') as title, (SELECT ''```json\n'' || args_json || ''\n```'' FROM orch_session WHERE orch_session_id = $session_id) as contents_md;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Diagnostics '') as title, (SELECT diagnostics_md FROM orch_session WHERE orch_session_id = $session_id) as contents_md;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-summary.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Summary'' as title;\nSELECT ''table'' as component, ''true'' as search;\nSELECT issue_type,COUNT(orch_session_issue_id) as issue_count from orch_session_issue group by issue_type;\n\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name\n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('DRH-screenings.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort, ''device'' as markdown;\n\n              SELECT *\n                FROM libre\n            GROUP BY device\n            ORDER BY ''time stamp'';\n\nSELECT ''text'' as component, (SELECT * FROM libre ) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE coalesce($pat_mrn_id, '''') <> '''';\n\n            SELECT *\n              FROM libre\n             ;\nSELECT ''text'' as component, (select * from libre)  as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM libre\n             ;\nSELECT ''text'' as component, (select * from libre ) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM libre\n             ;\nSELECT ''text'' as component, (select * from libre) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM libre\n             ;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Information Model (Schema) Documentation'' as title, ''TODO (description)'' as contents_md;\n\nSELECT ''table'' as component, ''table_name'' as markdown;\n\n          SELECT format(''[%s](?table_name=%s&table_nature)'', m.tbl_name, m.tbl_name, m.type) AS table_name,\n                 (SELECT COUNT(*) FROM sqlite_master sm2 JOIN pragma_table_info(m.tbl_name) cc ON 1=1 WHERE sm2.tbl_name = m.tbl_name) AS columns_count,\n                 m.type as nature\n            FROM sqlite_master m\n        ORDER BY table_name\n      ;\n\nSELECT ''text'' as component, ($table_name || '' '' || $table_nature || '' columns'' ) as title, ''TODO (lineage, governance, description, etc.)'' as contents_md WHERE coalesce($table_name, '''') <> '''';\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT\n              ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS column_num,\n              -- TODO: add governance information (e.g. description, etc. from SQLa)\n              CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n              c.name AS column_name,\n              c.\"type\" AS column_type,\n              CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n              COALESCE(c.dflt_value, '''') AS default_value,\n              COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs\n              -- TODO: add \"is_indexed\" and other details\n            FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n            WHERE m.tbl_name = $table_name;\n\nSELECT ''text'' as component, ($table_name || '' indexes'') as title;\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT il.name as \"Index Name\", group_concat(ii.name, '', '') as columns\n              FROM sqlite_master as m, pragma_index_list(m.name) AS il, pragma_index_info(il.name) AS ii\n             WHERE m.tbl_name = $table_name\n             GROUP BY m.name, il.name;\n\n-- TODO: add PlantUML or Mermaid ERD through SQL as emitted by tbls (use ChatGPT to create)\n    ;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;;\n\n-- emit all the execution diagnostics\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('168a34c7-d043-5ec4-a84a-c961f1a301ef', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'init', 'duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''7bab389e-54af-5a13-a39f-079abdc73a48'', ''vinod-OptiPlex'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7bab389e-54af-5a13-a39f-079abdc73a48'', ''0.12.0'', (''2024-04-16T08:48:44.333Z''), NULL, NULL, NULL, NULL, ''Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found', NULL, NULL, NULL, '\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''7bab389e-54af-5a13-a39f-079abdc73a48'', ''vinod-OptiPlex'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7bab389e-54af-5a13-a39f-079abdc73a48'', ''0.12.0'', (''2024-04-16T08:48:44.333Z''), NULL, NULL, NULL, NULL, ''Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('46171763-bd21-57a8-a403-0785f72643cf', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'ingest', 'duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb --json', 1, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv (libre_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv'', ''libre_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv'', types={''device'': ''VARCHAR'', ''serial number'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_20240307.'',\n           ''Ensure libre_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB004_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''47277588-99e8-59f5-8384-b24344a86073'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB001_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB006_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''Unknown CSV File Type'', ''CSV file ''''synthetic-fail.csv'''' not found in ''''synthetic-fail.csv'''''', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv (glucose_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv'', ''glucose_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE glucose_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''glucose_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in glucose_20240307.'',\n           ''Ensure glucose_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b004_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b004_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB004_Libre_data'' into libre_data_240402_m_y_b004_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b004_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB004_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b004_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b004_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b004_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b001_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b001_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB001_Libre_data'' into libre_data_240402_m_y_b001_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b001_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''a530fe1b-57ef-5a90-8bea-835ece2483da'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB001_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b001_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b001_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b001_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b006_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b006_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB006_Libre_data'' into libre_data_240402_m_y_b006_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b006_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''e36daa69-3c63-5384-b6a7-03fa3b00641d'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB006_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b006_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b006_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b006_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv (vitalsigns_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv'', ''vitalsigns_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE vitalsigns_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv'', types={''dataset_id'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''vitalsigns_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in vitalsigns_20240307.'',\n           ''Ensure vitalsigns_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv'', ''screening_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'' as session_entry_id\n    FROM read_csv_auto(''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Lvl''), (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_status_code_reference.'',\n           ''Ensure screening_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv'', ''business_rules'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9860873a-c387-5d98-9930-4ff296eb7192'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'' as session_entry_id\n    FROM read_csv_auto(''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Worksheet''), (''Field''), (''Required''), (''Permissible Values''), (''True Rejection''), (''Warning Layer''), (''Resolved by QE/QCS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''business_rules'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in business_rules.'',\n           ''Ensure business_rules contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''641dff51-97fd-56b3-8443-c1ed568a6d66'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a26ce332-3ced-5623-861d-23a2ef78e4a9'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''ae477ba1-c7f1-5f34-847a-50bddb7130aa'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''glucose_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b004_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b001_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b006_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''vitalsigns_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_status_code_reference'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''business_rules'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05269d28-15ae-5bd6-bd88-f949ccfa52d7''', 'Error: near line 67: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\nError: near line 201: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\n', '[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB004_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB001_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"orch_session_issue_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB006_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"orch_session_issue_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv\"}]\n', 'JSON', '\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv (libre_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv'', ''libre_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv'', types={''device'': ''VARCHAR'', ''serial number'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_20240307.'',\n           ''Ensure libre_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB004_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''47277588-99e8-59f5-8384-b24344a86073'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB001_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB006_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''Unknown CSV File Type'', ''CSV file ''''synthetic-fail.csv'''' not found in ''''synthetic-fail.csv'''''', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv (glucose_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv'', ''glucose_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE glucose_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''glucose_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in glucose_20240307.'',\n           ''Ensure glucose_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b004_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b004_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB004_Libre_data'' into libre_data_240402_m_y_b004_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b004_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB004_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b004_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b004_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b004_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b001_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b001_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB001_Libre_data'' into libre_data_240402_m_y_b001_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b001_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''a530fe1b-57ef-5a90-8bea-835ece2483da'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB001_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b001_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b001_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b001_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b006_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b006_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB006_Libre_data'' into libre_data_240402_m_y_b006_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b006_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''e36daa69-3c63-5384-b6a7-03fa3b00641d'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB006_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b006_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b006_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b006_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv (vitalsigns_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv'', ''vitalsigns_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE vitalsigns_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv'', types={''dataset_id'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''vitalsigns_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in vitalsigns_20240307.'',\n           ''Ensure vitalsigns_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv'', ''screening_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'' as session_entry_id\n    FROM read_csv_auto(''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Lvl''), (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_status_code_reference.'',\n           ''Ensure screening_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv'', ''business_rules'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9860873a-c387-5d98-9930-4ff296eb7192'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'' as session_entry_id\n    FROM read_csv_auto(''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Worksheet''), (''Field''), (''Required''), (''Permissible Values''), (''True Rejection''), (''Warning Layer''), (''Resolved by QE/QCS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''business_rules'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in business_rules.'',\n           ''Ensure business_rules contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''641dff51-97fd-56b3-8443-c1ed568a6d66'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a26ce332-3ced-5623-861d-23a2ef78e4a9'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''ae477ba1-c7f1-5f34-847a-50bddb7130aa'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''glucose_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b004_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b001_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b006_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''vitalsigns_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_status_code_reference'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''business_rules'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05269d28-15ae-5bd6-bd88-f949ccfa52d7''\n```\n### `ingest` STDOUT (status: `1`)\n```json\n[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB004_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB001_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"orch_session_issue_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB006_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"orch_session_issue_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv\"}]\n\n```\n### `ingest` STDERR\n```sh\nError: near line 67: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\nError: near line 201: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\n\n```\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'ensureContent', 'duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c2c0cbca-70cb-54f6-9dc7-66b47c4f3157'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e8b3dab4-5058-5c79-8088-45b423119149'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9dabd022-4a26-55f2-98f4-e534e7704b23'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''544998d3-58c5-5f65-9dc8-9f998508495f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''80af4eff-d697-565b-9e3f-a587e322b1da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n        \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6fcd9df5-34cf-5c09-8fb5-e73617e28d73'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''10d0290c-b2eb-581e-b627-b5b8fcbb830f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7e65e3a7-4415-55f4-866b-3b0cc4e85fc6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e6951d0b-be59-58c3-8a04-01181208c601'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2afb3098-bcfd-5a54-8ebb-4d65d399c55e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a92a6466-6fe4-58d7-8948-e2e09dc2fec2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34e90086-3d06-5b10-972d-7d0b40a02289'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      ', NULL, NULL, NULL, '\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c2c0cbca-70cb-54f6-9dc7-66b47c4f3157'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e8b3dab4-5058-5c79-8088-45b423119149'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9dabd022-4a26-55f2-98f4-e534e7704b23'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''544998d3-58c5-5f65-9dc8-9f998508495f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''80af4eff-d697-565b-9e3f-a587e322b1da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n        \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6fcd9df5-34cf-5c09-8fb5-e73617e28d73'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''10d0290c-b2eb-581e-b627-b5b8fcbb830f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7e65e3a7-4415-55f4-866b-3b0cc4e85fc6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e6951d0b-be59-58c3-8a04-01181208c601'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2afb3098-bcfd-5a54-8ebb-4d65d399c55e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a92a6466-6fe4-58d7-8948-e2e09dc2fec2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34e90086-3d06-5b10-972d-7d0b40a02289'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    ', NULL);;\n-- diagnostics-md-ignore-finish \"SQLPage and execution diagnostics SQL DML\"\n\nCREATE VIEW orch_session_issue_classification AS\nWITH cte_business_rule AS (\n  SELECT worksheet as worksheet,\n      field as field,\n      required as required,\n      \"Resolved by QE/QCS\" as resolved_by_qe_qcs,\n      CONCAT(\n          CASE WHEN UPPER(\"True Rejection\") = 'YES' THEN 'REJECTION' ELSE '' END,\n          CASE WHEN UPPER(\"Warning Layer\") = 'YES' THEN 'WARNING' ELSE '' END\n      ) AS record_action\n  FROM\n      \"ingestion-center\".main.business_rules\n)\n--select * from cte_business_rule\n\nSELECT\n  -- Including all other columns from 'orch_session'\n  ises.* EXCLUDE (orch_started_at, orch_finished_at),\n  -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n    -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n    -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n  -- Including all columns from 'orch_session_entry'\n  isee.* EXCLUDE (session_id),\n  -- Including all other columns from 'orch_session_issue'\n  isi.* EXCLUDE (session_id, session_entry_id),\n  CASE\n    WHEN\n        UPPER(isi.issue_type) = 'MISSING COLUMN'\n      THEN\n        'STRUCTURAL ISSUE'\n      ELSE\n        br.record_action\n    END\n  AS disposition,\n  case when UPPER(br.resolved_by_qe_qcs) = 'YES' then 'Resolved By QE/QCS' else null end AS remediation\n  FROM orch_session AS ises\n  JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n  LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id\n  --LEFT JOIN business_rules br ON isi.issue_column = br.FIELD\n  LEFT OUTER JOIN cte_business_rule br ON br.field = isi.issue_column\n  WHERE isi.orch_session_issue_id IS NOT NULL\n;\n\nATTACH '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86ff3ab6-900d-5474-b63c-cbcac3c66f1a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ASSURED_CSV', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('413ec5cd-eee9-5c62-90a5-6670f8b9ddff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS libre AS SELECT * FROM libre_20240307 WHERE 0=1;\nINSERT INTO libre SELECT * FROM libre_20240307;\n\nCREATE TABLE resource_db.libre_20240307 AS SELECT * FROM libre_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.libre AS SELECT * FROM libre_20240307 WHERE 0=1;\nINSERT INTO resource_db.libre SELECT * FROM libre_20240307;\n\n\n\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f6d4aff4-4b71-5662-8f57-00ee247dc57c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ASSURED_CSV', 'EXIT(QeAdminDataCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS glucose AS SELECT * FROM glucose_20240307 WHERE 0=1;\nINSERT INTO glucose SELECT * FROM glucose_20240307;\n\nCREATE TABLE resource_db.glucose_20240307 AS SELECT * FROM glucose_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.glucose AS SELECT * FROM glucose_20240307 WHERE 0=1;\nINSERT INTO resource_db.glucose SELECT * FROM glucose_20240307;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6c48996f-0dd4-572f-b087-e5913926cd4b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6202ec4a-f3d5-5302-9ed6-9cb59a5b2818', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.libre_data_240402_m_y_b004_libre_data AS SELECT * FROM libre_data_240402_m_y_b004_libre_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('bebf797d-855b-5e76-93d2-2a802febd5a2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4b7537b2-9d60-59f3-8c61-fa2ff4265c02', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.libre_data_240402_m_y_b001_libre_data AS SELECT * FROM libre_data_240402_m_y_b001_libre_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('17cedd6e-e794-5b45-9790-c4ba2483cc1e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(ScreeningExcelSheetIngestSource)', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('657d6337-8d24-5b67-b139-87db6a228264', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.libre_data_240402_m_y_b006_libre_data AS SELECT * FROM libre_data_240402_m_y_b006_libre_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c40829eb-7f91-583a-8af8-06de851777a0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9f13dd7d-9ff8-509d-b716-cde856c5f0f0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ASSURED_CSV', 'EXIT(AdminDemographicCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS vitalsigns AS SELECT * FROM vitalsigns_20240307 WHERE 0=1;\nINSERT INTO vitalsigns SELECT * FROM vitalsigns_20240307;\n\nCREATE TABLE resource_db.vitalsigns_20240307 AS SELECT * FROM vitalsigns_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.vitalsigns AS SELECT * FROM vitalsigns_20240307 WHERE 0=1;\nINSERT INTO resource_db.vitalsigns SELECT * FROM vitalsigns_20240307;\n\n\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a8ec8b43-9e16-5eeb-9683-bc14288971f1', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c0d34d3-bf09-527a-aef5-85004a400be5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ASSURED_CSV', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.screening_status_code_reference AS SELECT * FROM screening_status_code_reference WHERE 0=1;\nINSERT INTO resource_db.screening_status_code_reference SELECT * FROM screening_status_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('35c62034-5b20-5891-8d38-3e9b051dec6e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e2816d61-4406-5073-ac60-f129a107d938', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ASSURED_CSV', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.business_rules AS SELECT * FROM business_rules WHERE 0=1;\nINSERT INTO resource_db.business_rules SELECT * FROM business_rules;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aa8b8d1a-c8cc-5a9b-b5aa-34a6fc85e11a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ATTEMPT_CSV_EXPORT', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  ;\n\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided",
        "orch_session_exec_id": "8278fd0f-7116-55bd-8d7a-0a30681b0d2f",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4971a2f5-06a3-5898-823d-364145d3b9a5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4f7e4436-c5f6-5ba1-9793-580ab66789fb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\n\n-- diagnostics-md-ignore-start \"SQLPage and execution diagnostics SQL DML\"\n-- emit all the SQLPage content\nCREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n\n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/info_model_schema_tables.handlebars', '{{caption}}\n<ul>\n{{#each_row}}\n    <li><a href=\"?table_nature={{nature}}&table_name={{table_name}}\">{{table_name}}</a> ({{nature}}, {{columns_count}} columns)</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('scripts/shell.js', 'function wrapSTDOUTInDetails() {\n    // Find all heading elements that could contain the STDOUT text\n    const headings = document.querySelectorAll(''h1, h2, h3, h4, h5, h6'');\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n            // Find the next <pre><code> block\n            var nextEl = heading.nextElementSibling;\n            while (nextEl) {\n                if (nextEl.matches(''pre'') && nextEl.querySelector(''code'')) {\n                    // Create the <details> and <summary> elements\n                    const details = document.createElement(''details'');\n                    const summary = document.createElement(''summary'');\n                    summary.textContent = heading.textContent;\n\n                    // Wrap the <pre><code> block in <details>\n                    nextEl.parentNode.insertBefore(details, nextEl);\n                    details.appendChild(summary);\n                    details.appendChild(nextEl);\n                    break;\n                }\n                nextEl = nextEl.nextElementSibling;\n            }\n        }\n    });\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n          heading.remove();\n        }\n    });\n}\n\ndocument.addEventListener(''DOMContentLoaded'', function() {\n  // find all code elements on the current page with the class ''language-sql'' and add the class ''line-numbers'' to each of them\n  document.querySelectorAll(''code.language-sql'').forEach(function(codeEl) {\n      var parentPre = codeEl.parentElement;\n      if (parentPre && parentPre.tagName === ''PRE'') {\n          parentPre.classList.add(''line-numbers'');\n      }\n  });\n  wrapSTDOUTInDetails();\n});\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''list'' as component;\nSELECT ''DRH Screenings'' as title,''DRH-screenings.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component, ''orch_session_id'' as markdown, ''SUMMARY'' as markdown;\nSELECT ''['' || orch_session_id || ''](session-diagnostics.sql?session_id=''|| orch_session_id ||'')'' as orch_session_id,''['' || ''Summary'' || ''](session-summary.sql?session_id=''|| orch_session_id ||'')'' as SUMMARY, device_id, orch_started_at, orch_finished_at FROM orch_session;\n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('reference.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, ''Business Rules'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM business_rules;\n\nSELECT ''text'' as component, ''AHC Cross Walk'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM ahc_cross_walk;\n\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-diagnostics.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Arguments '') as title, (SELECT ''```json\n'' || args_json || ''\n```'' FROM orch_session WHERE orch_session_id = $session_id) as contents_md;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Diagnostics '') as title, (SELECT diagnostics_md FROM orch_session WHERE orch_session_id = $session_id) as contents_md;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-summary.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Summary'' as title;\nSELECT ''table'' as component, ''true'' as search;\nSELECT issue_type,COUNT(orch_session_issue_id) as issue_count from orch_session_issue group by issue_type;\n\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name\n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('DRH-screenings.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort, ''device'' as markdown;\n\n              SELECT *\n                FROM libre\n            GROUP BY device\n            ORDER BY ''time stamp'';\n\nSELECT ''text'' as component, (SELECT * FROM libre ) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE coalesce($pat_mrn_id, '''') <> '''';\n\n            SELECT *\n              FROM libre\n             ;\nSELECT ''text'' as component, (select * from libre)  as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM libre\n             ;\nSELECT ''text'' as component, (select * from libre ) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM libre\n             ;\nSELECT ''text'' as component, (select * from libre) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT *\n              FROM libre\n             ;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"DRH\",\"link\":\"/DRH-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Information Model (Schema) Documentation'' as title, ''TODO (description)'' as contents_md;\n\nSELECT ''table'' as component, ''table_name'' as markdown;\n\n          SELECT format(''[%s](?table_name=%s&table_nature)'', m.tbl_name, m.tbl_name, m.type) AS table_name,\n                 (SELECT COUNT(*) FROM sqlite_master sm2 JOIN pragma_table_info(m.tbl_name) cc ON 1=1 WHERE sm2.tbl_name = m.tbl_name) AS columns_count,\n                 m.type as nature\n            FROM sqlite_master m\n        ORDER BY table_name\n      ;\n\nSELECT ''text'' as component, ($table_name || '' '' || $table_nature || '' columns'' ) as title, ''TODO (lineage, governance, description, etc.)'' as contents_md WHERE coalesce($table_name, '''') <> '''';\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT\n              ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS column_num,\n              -- TODO: add governance information (e.g. description, etc. from SQLa)\n              CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n              c.name AS column_name,\n              c.\"type\" AS column_type,\n              CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n              COALESCE(c.dflt_value, '''') AS default_value,\n              COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs\n              -- TODO: add \"is_indexed\" and other details\n            FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n            WHERE m.tbl_name = $table_name;\n\nSELECT ''text'' as component, ($table_name || '' indexes'') as title;\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT il.name as \"Index Name\", group_concat(ii.name, '', '') as columns\n              FROM sqlite_master as m, pragma_index_list(m.name) AS il, pragma_index_info(il.name) AS ii\n             WHERE m.tbl_name = $table_name\n             GROUP BY m.name, il.name;\n\n-- TODO: add PlantUML or Mermaid ERD through SQL as emitted by tbls (use ChatGPT to create)\n    ;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;;\n\n-- emit all the execution diagnostics\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('168a34c7-d043-5ec4-a84a-c961f1a301ef', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'init', 'duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''7bab389e-54af-5a13-a39f-079abdc73a48'', ''vinod-OptiPlex'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7bab389e-54af-5a13-a39f-079abdc73a48'', ''0.12.0'', (''2024-04-16T08:48:44.333Z''), NULL, NULL, NULL, NULL, ''Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found', NULL, NULL, NULL, '\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"version\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''7bab389e-54af-5a13-a39f-079abdc73a48'', ''vinod-OptiPlex'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"version\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7bab389e-54af-5a13-a39f-079abdc73a48'', ''0.12.0'', (''2024-04-16T08:48:44.333Z''), NULL, NULL, NULL, NULL, ''Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('46171763-bd21-57a8-a403-0785f72643cf', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'ingest', 'duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb --json', 1, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv (libre_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv'', ''libre_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv'', types={''device'': ''VARCHAR'', ''serial number'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_20240307.'',\n           ''Ensure libre_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB004_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''47277588-99e8-59f5-8384-b24344a86073'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB001_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB006_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''Unknown CSV File Type'', ''CSV file ''''synthetic-fail.csv'''' not found in ''''synthetic-fail.csv'''''', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv (glucose_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv'', ''glucose_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE glucose_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''glucose_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in glucose_20240307.'',\n           ''Ensure glucose_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b004_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b004_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB004_Libre_data'' into libre_data_240402_m_y_b004_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b004_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB004_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b004_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b004_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b004_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b001_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b001_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB001_Libre_data'' into libre_data_240402_m_y_b001_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b001_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''a530fe1b-57ef-5a90-8bea-835ece2483da'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB001_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b001_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b001_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b001_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b006_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b006_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB006_Libre_data'' into libre_data_240402_m_y_b006_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b006_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''e36daa69-3c63-5384-b6a7-03fa3b00641d'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB006_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b006_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b006_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b006_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv (vitalsigns_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv'', ''vitalsigns_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE vitalsigns_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv'', types={''dataset_id'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''vitalsigns_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in vitalsigns_20240307.'',\n           ''Ensure vitalsigns_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv'', ''screening_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'' as session_entry_id\n    FROM read_csv_auto(''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Lvl''), (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_status_code_reference.'',\n           ''Ensure screening_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv'', ''business_rules'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9860873a-c387-5d98-9930-4ff296eb7192'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'' as session_entry_id\n    FROM read_csv_auto(''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Worksheet''), (''Field''), (''Required''), (''Permissible Values''), (''True Rejection''), (''Warning Layer''), (''Resolved by QE/QCS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''business_rules'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in business_rules.'',\n           ''Ensure business_rules contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''641dff51-97fd-56b3-8443-c1ed568a6d66'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a26ce332-3ced-5623-861d-23a2ef78e4a9'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''ae477ba1-c7f1-5f34-847a-50bddb7130aa'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''glucose_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b004_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b001_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b006_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''vitalsigns_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_status_code_reference'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''business_rules'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05269d28-15ae-5bd6-bd88-f949ccfa52d7''', 'Error: near line 67: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\nError: near line 201: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\n', '[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB004_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB001_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"orch_session_issue_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB006_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"orch_session_issue_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv\"}]\n', 'JSON', '\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv (libre_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv'', ''libre_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/LIBRE_20240307.csv'', types={''device'': ''VARCHAR'', ''serial number'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_20240307.'',\n           ''Ensure libre_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB004_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''47277588-99e8-59f5-8384-b24344a86073'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB001_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''Sheet Missing'', ''Excel workbook sheet ''''MYB006_Libre_data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''Unknown CSV File Type'', ''CSV file ''''synthetic-fail.csv'''' not found in ''''synthetic-fail.csv'''''', NULL, NULL, ''support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv'', NULL, NULL);\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv (glucose_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv'', ''glucose_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE glucose_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/GLUCOSE_20240307.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''glucose_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in glucose_20240307.'',\n           ''Ensure glucose_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b004_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b004_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB004_Libre_data'' into libre_data_240402_m_y_b004_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b004_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB004_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b004_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b004_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b004_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b001_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b001_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB001_Libre_data'' into libre_data_240402_m_y_b001_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b001_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''a530fe1b-57ef-5a90-8bea-835ece2483da'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB001_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b001_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b001_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b001_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx (libre_data_240402_m_y_b006_libre_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', ''libre_data_240402_m_y_b006_libre_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''MYB006_Libre_data'' into libre_data_240402_m_y_b006_libre_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE libre_data_240402_m_y_b006_libre_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''e36daa69-3c63-5384-b6a7-03fa3b00641d'' as session_entry_id\n    FROM st_read(''support/assurance/ingestion-center-elt/drh/synthetic-content/Libre_data_240402.xlsx'', layer=''MYB006_Libre_data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''device''), (''serial number''), (''time stamp''), (''glucose value'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''libre_data_240402_m_y_b006_libre_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in libre_data_240402_m_y_b006_libre_data.'',\n           ''Ensure libre_data_240402_m_y_b006_libre_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv (vitalsigns_20240307)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv'', ''vitalsigns_20240307'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE vitalsigns_20240307 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ingestion-center-elt/drh/synthetic-content/vitalsigns_20240307.csv'', types={''dataset_id'': ''VARCHAR''});\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''vitalsigns_20240307'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in vitalsigns_20240307.'',\n           ''Ensure vitalsigns_20240307 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv (screening_status_code_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv'', ''screening_status_code_reference'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_status_code_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'' as session_entry_id\n    FROM read_csv_auto(''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/screening-status-code-reference.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Lvl''), (''Code''), (''Display''), (''Definition'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_status_code_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_status_code_reference.'',\n           ''Ensure screening_status_code_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n-- ingest /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv (business_rules)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv'', ''business_rules'', NULL);\n\n-- state management diagnostics\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9860873a-c387-5d98-9930-4ff296eb7192'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE business_rules AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'' as session_entry_id\n    FROM read_csv_auto(''/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/src/ingestion-center-elt/reference-data/business-rules.csv'',\n      header = true\n    );\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''Worksheet''), (''Field''), (''Required''), (''Permissible Values''), (''True Rejection''), (''Warning Layer''), (''Resolved by QE/QCS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''business_rules'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in business_rules.'',\n           ''Ensure business_rules contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''641dff51-97fd-56b3-8443-c1ed568a6d66'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a26ce332-3ced-5623-861d-23a2ef78e4a9'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''ERROR'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''ae477ba1-c7f1-5f34-847a-50bddb7130aa'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''glucose_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b004_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b001_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''libre_data_240402_m_y_b006_libre_data'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''vitalsigns_20240307'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''screening_status_code_reference'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nWITH check_all_tables_are_ingested_in_a_group AS (\n  WITH required_tables AS (\n      SELECT ''libre_20240307''\n        AS table_name,\n        ''LIBRE'' AS table_name_suffix\n      UNION ALL\n      SELECT ''vitalsigns_20240307''\n        AS table_name,\n        ''VITALSIGNS'' AS table_name_suffix\n      UNION ALL\n      SELECT ''glucose_20240307''\n        AS table_name,\n        ''GLUCOSE'' AS table_name_suffix\n  )\n  SELECT rt.table_name as table_name, rt.table_name_suffix as table_name_suffix\n  FROM required_tables rt\n  LEFT JOIN information_schema.tables ist ON rt.table_name = ist.table_name\n  WHERE\n    ''business_rules'' IN (\n      ''libre_20240307'',\n      ''vitalsigns_20240307'',\n      ''glucose_20240307''\n      )\n  AND ist.table_name IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'',\n           ''CSV File Missing'',\n           NULL,\n           NULL,\n           table_name,\n           ''CSV file '' || table_name_suffix || ''_20240307 not found under the group (_20240307)'',\n           NULL\n      FROM check_all_tables_are_ingested_in_a_group\n    ;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05269d28-15ae-5bd6-bd88-f949ccfa52d7''\n```\n### `ingest` STDOUT (status: `1`)\n```json\n[{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB004_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB001_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"orch_session_issue_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''MYB006_Libre_data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"orch_session_issue_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''\",\"invalid_value\":\"support/assurance/ingestion-center-elt/drh/synthetic-content/synthetic-fail.csv\"}]\n\n```\n### `ingest` STDERR\n```sh\nError: near line 67: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\nError: near line 201: Parser Error: syntax error at or near \")\"\nLINE 3:       FROM (VALUES ) AS required(column_name)\n                           ^\n\n```\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'ensureContent', 'duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c2c0cbca-70cb-54f6-9dc7-66b47c4f3157'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e8b3dab4-5058-5c79-8088-45b423119149'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9dabd022-4a26-55f2-98f4-e534e7704b23'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''544998d3-58c5-5f65-9dc8-9f998508495f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''80af4eff-d697-565b-9e3f-a587e322b1da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n        \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6fcd9df5-34cf-5c09-8fb5-e73617e28d73'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''10d0290c-b2eb-581e-b627-b5b8fcbb830f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7e65e3a7-4415-55f4-866b-3b0cc4e85fc6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e6951d0b-be59-58c3-8a04-01181208c601'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2afb3098-bcfd-5a54-8ebb-4d65d399c55e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a92a6466-6fe4-58d7-8948-e2e09dc2fec2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34e90086-3d06-5b10-972d-7d0b40a02289'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      ', NULL, NULL, NULL, '\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c2c0cbca-70cb-54f6-9dc7-66b47c4f3157'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_20240307\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e8b3dab4-5058-5c79-8088-45b423119149'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9dabd022-4a26-55f2-98f4-e534e7704b23'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''544998d3-58c5-5f65-9dc8-9f998508495f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b004_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''80af4eff-d697-565b-9e3f-a587e322b1da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b001_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''a530fe1b-57ef-5a90-8bea-835ece2483da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n        \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6fcd9df5-34cf-5c09-8fb5-e73617e28d73'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''10d0290c-b2eb-581e-b627-b5b8fcbb830f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''device'' AS issue_column,\n           \"device\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"device\" IS NULL\n        OR TRIM(\"device\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''serial number'' AS issue_column,\n           \"serial number\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"serial number\" IS NULL\n        OR TRIM(\"serial number\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''time stamp'' AS issue_column,\n           \"time stamp\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"time stamp\" IS NULL\n        OR TRIM(\"time stamp\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''glucose value'' AS issue_column,\n           \"glucose value\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"libre_data_240402_m_y_b006_libre_data\"\n     WHERE \"glucose value\" IS NULL\n        OR TRIM(\"glucose value\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e36daa69-3c63-5384-b6a7-03fa3b00641d'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7e65e3a7-4415-55f4-866b-3b0cc4e85fc6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e6951d0b-be59-58c3-8a04-01181208c601'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n     \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''2afb3098-bcfd-5a54-8ebb-4d65d399c55e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a92a6466-6fe4-58d7-8948-e2e09dc2fec2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningStatusCodeReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- add field validation\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34e90086-3d06-5b10-972d-7d0b40a02289'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''BusinessRulesReferenceCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n      \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    ', NULL);;\n-- diagnostics-md-ignore-finish \"SQLPage and execution diagnostics SQL DML\"\n\nCREATE VIEW orch_session_issue_classification AS\nWITH cte_business_rule AS (\n  SELECT worksheet as worksheet,\n      field as field,\n      required as required,\n      \"Resolved by QE/QCS\" as resolved_by_qe_qcs,\n      CONCAT(\n          CASE WHEN UPPER(\"True Rejection\") = 'YES' THEN 'REJECTION' ELSE '' END,\n          CASE WHEN UPPER(\"Warning Layer\") = 'YES' THEN 'WARNING' ELSE '' END\n      ) AS record_action\n  FROM\n      \"ingestion-center\".main.business_rules\n)\n--select * from cte_business_rule\n\nSELECT\n  -- Including all other columns from 'orch_session'\n  ises.* EXCLUDE (orch_started_at, orch_finished_at),\n  -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n    -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n    -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n  -- Including all columns from 'orch_session_entry'\n  isee.* EXCLUDE (session_id),\n  -- Including all other columns from 'orch_session_issue'\n  isi.* EXCLUDE (session_id, session_entry_id),\n  CASE\n    WHEN\n        UPPER(isi.issue_type) = 'MISSING COLUMN'\n      THEN\n        'STRUCTURAL ISSUE'\n      ELSE\n        br.record_action\n    END\n  AS disposition,\n  case when UPPER(br.resolved_by_qe_qcs) = 'YES' then 'Resolved By QE/QCS' else null end AS remediation\n  FROM orch_session AS ises\n  JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n  LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id\n  --LEFT JOIN business_rules br ON isi.issue_column = br.FIELD\n  LEFT OUTER JOIN cte_business_rule br ON br.field = isi.issue_column\n  WHERE isi.orch_session_issue_id IS NOT NULL\n;\n\nATTACH '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86ff3ab6-900d-5474-b63c-cbcac3c66f1a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ASSURED_CSV', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('413ec5cd-eee9-5c62-90a5-6670f8b9ddff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS libre AS SELECT * FROM libre_20240307 WHERE 0=1;\nINSERT INTO libre SELECT * FROM libre_20240307;\n\nCREATE TABLE resource_db.libre_20240307 AS SELECT * FROM libre_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.libre AS SELECT * FROM libre_20240307 WHERE 0=1;\nINSERT INTO resource_db.libre SELECT * FROM libre_20240307;\n\n\n\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f6d4aff4-4b71-5662-8f57-00ee247dc57c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ASSURED_CSV', 'EXIT(QeAdminDataCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS glucose AS SELECT * FROM glucose_20240307 WHERE 0=1;\nINSERT INTO glucose SELECT * FROM glucose_20240307;\n\nCREATE TABLE resource_db.glucose_20240307 AS SELECT * FROM glucose_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.glucose AS SELECT * FROM glucose_20240307 WHERE 0=1;\nINSERT INTO resource_db.glucose SELECT * FROM glucose_20240307;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6c48996f-0dd4-572f-b087-e5913926cd4b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6202ec4a-f3d5-5302-9ed6-9cb59a5b2818', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.libre_data_240402_m_y_b004_libre_data AS SELECT * FROM libre_data_240402_m_y_b004_libre_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('bebf797d-855b-5e76-93d2-2a802febd5a2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4b7537b2-9d60-59f3-8c61-fa2ff4265c02', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.libre_data_240402_m_y_b001_libre_data AS SELECT * FROM libre_data_240402_m_y_b001_libre_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('17cedd6e-e794-5b45-9790-c4ba2483cc1e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(ScreeningExcelSheetIngestSource)', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('657d6337-8d24-5b67-b139-87db6a228264', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.libre_data_240402_m_y_b006_libre_data AS SELECT * FROM libre_data_240402_m_y_b006_libre_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c40829eb-7f91-583a-8af8-06de851777a0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9f13dd7d-9ff8-509d-b716-cde856c5f0f0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ASSURED_CSV', 'EXIT(AdminDemographicCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS vitalsigns AS SELECT * FROM vitalsigns_20240307 WHERE 0=1;\nINSERT INTO vitalsigns SELECT * FROM vitalsigns_20240307;\n\nCREATE TABLE resource_db.vitalsigns_20240307 AS SELECT * FROM vitalsigns_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.vitalsigns AS SELECT * FROM vitalsigns_20240307 WHERE 0=1;\nINSERT INTO resource_db.vitalsigns SELECT * FROM vitalsigns_20240307;\n\n\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a8ec8b43-9e16-5eeb-9683-bc14288971f1', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c0d34d3-bf09-527a-aef5-85004a400be5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ASSURED_CSV', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.screening_status_code_reference AS SELECT * FROM screening_status_code_reference WHERE 0=1;\nINSERT INTO resource_db.screening_status_code_reference SELECT * FROM screening_status_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('35c62034-5b20-5891-8d38-3e9b051dec6e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e2816d61-4406-5073-ac60-f129a107d938', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ASSURED_CSV', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.business_rules AS SELECT * FROM business_rules WHERE 0=1;\nINSERT INTO resource_db.business_rules SELECT * FROM business_rules;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aa8b8d1a-c8cc-5a9b-b5aa-34a6fc85e11a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ATTEMPT_CSV_EXPORT', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  ;\n\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## emitResources\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4971a2f5-06a3-5898-823d-364145d3b9a5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4f7e4436-c5f6-5ba1-9793-580ab66789fb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', ('2024-04-16T08:48:45.697Z'), NULL);\n\n-- removed SQLPage and execution diagnostics SQL DML from diagnostics Markdown\n\nCREATE VIEW orch_session_issue_classification AS\nWITH cte_business_rule AS (\n  SELECT worksheet as worksheet,\n      field as field,\n      required as required,\n      \"Resolved by QE/QCS\" as resolved_by_qe_qcs,\n      CONCAT(\n          CASE WHEN UPPER(\"True Rejection\") = 'YES' THEN 'REJECTION' ELSE '' END,\n          CASE WHEN UPPER(\"Warning Layer\") = 'YES' THEN 'WARNING' ELSE '' END\n      ) AS record_action\n  FROM\n      \"ingestion-center\".main.business_rules\n)\n--select * from cte_business_rule\n\nSELECT\n  -- Including all other columns from 'orch_session'\n  ises.* EXCLUDE (orch_started_at, orch_finished_at),\n  -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n    -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n    -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n  -- Including all columns from 'orch_session_entry'\n  isee.* EXCLUDE (session_id),\n  -- Including all other columns from 'orch_session_issue'\n  isi.* EXCLUDE (session_id, session_entry_id),\n  CASE\n    WHEN\n        UPPER(isi.issue_type) = 'MISSING COLUMN'\n      THEN\n        'STRUCTURAL ISSUE'\n      ELSE\n        br.record_action\n    END\n  AS disposition,\n  case when UPPER(br.resolved_by_qe_qcs) = 'YES' then 'Resolved By QE/QCS' else null end AS remediation\n  FROM orch_session AS ises\n  JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n  LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id\n  --LEFT JOIN business_rules br ON isi.issue_column = br.FIELD\n  LEFT OUTER JOIN cte_business_rule br ON br.field = isi.issue_column\n  WHERE isi.orch_session_issue_id IS NOT NULL\n;\n\nATTACH '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86ff3ab6-900d-5474-b63c-cbcac3c66f1a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ASSURED_CSV', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('413ec5cd-eee9-5c62-90a5-6670f8b9ddff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS libre AS SELECT * FROM libre_20240307 WHERE 0=1;\nINSERT INTO libre SELECT * FROM libre_20240307;\n\nCREATE TABLE resource_db.libre_20240307 AS SELECT * FROM libre_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.libre AS SELECT * FROM libre_20240307 WHERE 0=1;\nINSERT INTO resource_db.libre SELECT * FROM libre_20240307;\n\n\n\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f6d4aff4-4b71-5662-8f57-00ee247dc57c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ASSURED_CSV', 'EXIT(QeAdminDataCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS glucose AS SELECT * FROM glucose_20240307 WHERE 0=1;\nINSERT INTO glucose SELECT * FROM glucose_20240307;\n\nCREATE TABLE resource_db.glucose_20240307 AS SELECT * FROM glucose_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.glucose AS SELECT * FROM glucose_20240307 WHERE 0=1;\nINSERT INTO resource_db.glucose SELECT * FROM glucose_20240307;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6c48996f-0dd4-572f-b087-e5913926cd4b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6202ec4a-f3d5-5302-9ed6-9cb59a5b2818', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.libre_data_240402_m_y_b004_libre_data AS SELECT * FROM libre_data_240402_m_y_b004_libre_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('bebf797d-855b-5e76-93d2-2a802febd5a2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '3b4eb0e5-6239-537a-8e67-e50e172e72a2', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4b7537b2-9d60-59f3-8c61-fa2ff4265c02', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.libre_data_240402_m_y_b001_libre_data AS SELECT * FROM libre_data_240402_m_y_b001_libre_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('17cedd6e-e794-5b45-9790-c4ba2483cc1e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(ScreeningExcelSheetIngestSource)', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('657d6337-8d24-5b67-b139-87db6a228264', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.libre_data_240402_m_y_b006_libre_data AS SELECT * FROM libre_data_240402_m_y_b006_libre_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c40829eb-7f91-583a-8af8-06de851777a0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e36daa69-3c63-5384-b6a7-03fa3b00641d', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9f13dd7d-9ff8-509d-b716-cde856c5f0f0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ASSURED_CSV', 'EXIT(AdminDemographicCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS vitalsigns AS SELECT * FROM vitalsigns_20240307 WHERE 0=1;\nINSERT INTO vitalsigns SELECT * FROM vitalsigns_20240307;\n\nCREATE TABLE resource_db.vitalsigns_20240307 AS SELECT * FROM vitalsigns_20240307;\n\nCREATE TABLE IF NOT EXISTS resource_db.vitalsigns AS SELECT * FROM vitalsigns_20240307 WHERE 0=1;\nINSERT INTO resource_db.vitalsigns SELECT * FROM vitalsigns_20240307;\n\n\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a8ec8b43-9e16-5eeb-9683-bc14288971f1', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c0d34d3-bf09-527a-aef5-85004a400be5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ASSURED_CSV', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.screening_status_code_reference AS SELECT * FROM screening_status_code_reference WHERE 0=1;\nINSERT INTO resource_db.screening_status_code_reference SELECT * FROM screening_status_code_reference;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('35c62034-5b20-5891-8d38-3e9b051dec6e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'fa7874f6-f848-572b-a9ab-9db4c8d5e959', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningStatusCodeReferenceCsvFileIngestSource)', NULL, 'ScreeningStatusCodeReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e2816d61-4406-5073-ac60-f129a107d938', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ASSURED_CSV', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE IF NOT EXISTS resource_db.business_rules AS SELECT * FROM business_rules WHERE 0=1;\nINSERT INTO resource_db.business_rules SELECT * FROM business_rules;\n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aa8b8d1a-c8cc-5a9b-b5aa-34a6fc85e11a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'ATTEMPT_CSV_EXPORT', 'EXIT(BusinessRulesReferenceCsvFileIngestSource)', NULL, 'BusinessRulesReferenceCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  ;\n\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided\n```\nNo STDOUT emitted by `emitResources` (status: `0`).\n\nNo STDERR emitted by `emitResources`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "jsonResult_4",
        "exec_code": "duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb --json",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT COUNT(*) AS table_count FROM information_schema.tables WHERE table_name IN ('libre', 'vitalsigns', 'glucose');\n      ",
        "output_nature": "JSON",
        "orch_session_exec_id": "97c2cca2-92f5-5937-97e6-d84beeb4018e",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT COUNT(*) AS table_count FROM information_schema.tables WHERE table_name IN ('libre', 'vitalsigns', 'glucose');\n      ",
        "output_text": "[{\"table_count\":3}]\n",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## jsonResult_4\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nSELECT COUNT(*) AS table_count FROM information_schema.tables WHERE table_name IN ('libre', 'vitalsigns', 'glucose');\n      \n```\n### `jsonResult_4` STDOUT (status: `0`)\n```json\n[{\"table_count\":3}]\n\n```\nNo STDERR emitted by `jsonResult_4`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "emitDiagnostics",
        "exec_code": "duckdb /home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_issue_classification) TO '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');",
        "orch_session_exec_id": "f58ee169-7478-59ca-9e36-aa384ddb501c",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_issue_classification) TO '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## emitDiagnostics\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_issue_classification) TO '/home/vinod/projects/Diabetes Research Hub DRH_DOLT/INGESTION_GITHUB/personal_vinod.wst/ingestion-center/support/assurance/ingestion-center-elt/drh/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');\n```\nNo STDOUT emitted by `emitDiagnostics` (status: `0`).\n\nNo STDERR emitted by `emitDiagnostics`.\n\n    "
      }
    }
  ]
}